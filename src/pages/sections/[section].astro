---
import type { GetStaticPaths } from "astro";
import SectionLayout from "../../layouts/section-layout.astro";
import SectionHeader from "../../components/section/section-header.astro";
import { useStrapi } from "../../api/strapi";
import SectionItem from "../../components/section/section-item.astro";

export const getStaticPaths = (async () => {
  const { getSectionsUrl } = useStrapi();
  const sectionsUrl = await getSectionsUrl();
  return sectionsUrl.map((url) => ({
    params: { section: url },
  }));
}) satisfies GetStaticPaths;

const { section } = Astro.params;

const [{ attributes }] = await useStrapi().getSectionDetails(section);
const { title, photos, cover } = attributes;
---

<SectionLayout title={title}>
  <article class="section">
    <SectionHeader title={title} cover={cover.data.attributes} />
    <section class="p-6">
      <ul class="flex flex-wrap gap-1 md:gap-3">
        {photos.data.map((photo: any) => <SectionItem photo={photo} />)}
      </ul>
    </section>
  </article>
</SectionLayout>

<style>
  .section {
    perspective: 10px;
    height: 100vh;
    overflow-y: auto;
    overflow-x: hidden;
  }
</style>
