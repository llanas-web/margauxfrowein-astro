---
import type { GetStaticPaths } from "astro";
import SectionLayout from "../../layouts/section-layout.astro";
import SectionHeader from "../../components/section/section-header.astro";
import { useStrapi } from "../../api/strapi";

export const getStaticPaths = (async () => {
  const { getSectionsUrl } = useStrapi();
  const sectionsUrl = await getSectionsUrl();
  return sectionsUrl.map((url) => ({
    params: { section: url },
  }));
}) satisfies GetStaticPaths;

const { section } = Astro.params;

const [{ attributes }] = await useStrapi().getSectionDetails(section);
const { title, description, cover } = attributes;
---

<SectionLayout title={title}>
  <article class="">
    <SectionHeader title={title} cover={cover.data.attributes} />
  </article>
</SectionLayout>
